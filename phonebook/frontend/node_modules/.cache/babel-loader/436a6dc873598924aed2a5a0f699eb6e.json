{"ast":null,"code":"import _toConsumableArray from\"/Users/ahmed/Documents/PrintLearning/fullstackopen-2021/Part3/phonebook/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/ahmed/Documents/PrintLearning/fullstackopen-2021/Part3/phonebook/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Header from'./components/Header';import SearchFilter from'./components/SearchFilter';import AddPeopleForm from'./components/AddPeopleForm';import Persons from'./components/Persons';import Notification from'./components/Notification';import personService from'./services/personService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),filteredPersons=_useState8[0],setFilteredPersons=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),errorStatus=_useState12[0],setErrorStatus=_useState12[1];useEffect(function(){personService.getAll().then(function(peopleList){console.log(\"initial data\",peopleList);setPersons(peopleList);setFilteredPersons(peopleList);});},[]);var handleNameChange=function handleNameChange(event){return setNewName(event.target.value);};var handleNumberChange=function handleNumberChange(event){return setNewNumber(event.target.value);};var handleSearch=function handleSearch(event){var searchEntry=event.target.value.toLowerCase();if(searchEntry.length>0){setFilteredPersons(persons.filter(function(person){return person.name.toLowerCase().includes(searchEntry);}));}else{setFilteredPersons(_toConsumableArray(persons));}};var handleNotifications=function handleNotifications(message,status){setErrorMessage(message);setErrorStatus(status);setTimeout(function(){setErrorMessage(null);},5000);};var checkDuplicatePerson=function checkDuplicatePerson(person){var foundID=persons.find(function(p){return p.name===person.name;})?persons.find(function(p){return p.name===person.name;}).id:0;if(foundID===0){return false;}return foundID;};var concatPersonLists=function concatPersonLists(personObject){setPersons(persons.concat(personObject));setFilteredPersons(persons.concat(personObject));};var addPerson=function addPerson(event){var alertText=\"\".concat(newName,\" already exists. Update their phone number?\");event.preventDefault();var personObject={name:newName,number:newNumber};var foundID=checkDuplicatePerson(personObject);if(foundID){if(window.confirm(alertText)){personService.update(foundID,personObject).then(function(updatedPerson){handleNotifications(\"Changed number of \".concat(personObject.name),false);setFilteredPersons(filteredPersons.map(function(person){return person.name===newName?updatedPerson:person;}));setPersons(filteredPersons);});}}else{personService.create(personObject).then(function(personList){handleNotifications(\"\".concat(personObject.name,\" was added to the list\"),false);concatPersonLists(personList);setNewName('');setNewNumber('');}).catch(function(error){handleNotifications(error.response.data,true);});}};var deletePerson=function deletePerson(name,id){if(window.confirm(\"Delete \".concat(name,\"?\"))){personService.deleteObject(id).then(function(){handleNotifications(\"\".concat(name,\" was removed from the list\"),false);setFilteredPersons(filteredPersons.filter(function(person){return person.id!==id;}));setPersons(filteredPersons);}).catch(function(error){console.log(\"Caught Error\",error);handleNotifications(\"\".concat(name,\" has already been removed from the list\"),true);setFilteredPersons(filteredPersons.filter(function(person){return person.id!==id;}));setPersons(filteredPersons);});}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Notification,{message:errorMessage,errorStatus:errorStatus}),/*#__PURE__*/_jsx(Header,{text:\"Phonebook\"}),/*#__PURE__*/_jsx(SearchFilter,{text:\"filter shown with\",handleSearch:handleSearch}),/*#__PURE__*/_jsx(Header,{text:\"add a new\"}),/*#__PURE__*/_jsx(AddPeopleForm,{handleNameChange:handleNameChange,handleNumberChange:handleNumberChange,addPerson:addPerson,newName:newName,newNumber:newNumber}),/*#__PURE__*/_jsx(Header,{text:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{filteredPersons:filteredPersons,deletePerson:deletePerson})]});};export default App;","map":{"version":3,"sources":["/Users/ahmed/Documents/PrintLearning/fullstackopen-2021/Part3/phonebook/frontend/src/App.js"],"names":["React","useState","useEffect","Header","SearchFilter","AddPeopleForm","Persons","Notification","personService","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filteredPersons","setFilteredPersons","errorMessage","setErrorMessage","errorStatus","setErrorStatus","getAll","then","peopleList","console","log","handleNameChange","event","target","value","handleNumberChange","handleSearch","searchEntry","toLowerCase","length","filter","person","name","includes","handleNotifications","message","status","setTimeout","checkDuplicatePerson","foundID","find","p","id","concatPersonLists","personObject","concat","addPerson","alertText","preventDefault","number","window","confirm","update","updatedPerson","map","create","personList","catch","error","response","data","deletePerson","deleteObject"],"mappings":"8UAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CAEA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,2BAAzB,CACA,MAAOC,CAAAA,aAAP,KAA0B,4BAA1B,CACA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CACA,MAAOC,CAAAA,YAAP,KAAyB,2BAAzB,CACA,MAAOC,CAAAA,aAAP,KAA0B,0BAA1B,C,wFAEA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,eACgBR,QAAQ,CAAC,EAAD,CADxB,wCACRS,OADQ,eACCC,UADD,8BAEgBV,QAAQ,CAAC,EAAD,CAFxB,yCAERW,OAFQ,eAECC,UAFD,8BAGoBZ,QAAQ,CAAC,EAAD,CAH5B,yCAGRa,SAHQ,eAGGC,YAHH,8BAIgCd,QAAQ,CAAC,EAAD,CAJxC,yCAIRe,eAJQ,eAISC,kBAJT,8BAK0BhB,QAAQ,CAAC,IAAD,CALlC,0CAKRiB,YALQ,gBAKMC,eALN,gCAMwBlB,QAAQ,CAAC,IAAD,CANhC,2CAMRmB,WANQ,gBAMKC,cANL,gBAQhBnB,SAAS,CAAC,UAAM,CACdM,aAAa,CACVc,MADH,GAEGC,IAFH,CAEQ,SAAAC,UAAU,CAAI,CAClBC,OAAO,CAACC,GAAR,CAAY,cAAZ,CAA4BF,UAA5B,EACAb,UAAU,CAACa,UAAD,CAAV,CACAP,kBAAkB,CAACO,UAAD,CAAlB,CACD,CANH,EAOD,CARQ,CAQN,EARM,CAAT,CAUA,GAAMG,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,KAAD,QAAWf,CAAAA,UAAU,CAACe,KAAK,CAACC,MAAN,CAAaC,KAAd,CAArB,EAAzB,CAEA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACH,KAAD,QAAWb,CAAAA,YAAY,CAACa,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAvB,EAA3B,CAEA,GAAME,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACJ,KAAD,CAAW,CAC9B,GAAIK,CAAAA,WAAW,CAAIL,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAqBI,WAArB,EAAlB,CAEA,GAAGD,WAAW,CAACE,MAAZ,CAAqB,CAAxB,CAA2B,CACzBlB,kBAAkB,CAACP,OAAO,CAAC0B,MAAR,CAAe,SAAAC,MAAM,QAAIA,CAAAA,MAAM,CAACC,IAAP,CAAYJ,WAAZ,GAA0BK,QAA1B,CAAmCN,WAAnC,CAAJ,EAArB,CAAD,CAAlB,CACD,CAFD,IAEO,CACLhB,kBAAkB,oBAAKP,OAAL,EAAlB,CACD,CACF,CARD,CAUA,GAAM8B,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACC,OAAD,CAAUC,MAAV,CAAqB,CAC/CvB,eAAe,CAACsB,OAAD,CAAf,CACApB,cAAc,CAACqB,MAAD,CAAd,CACAC,UAAU,CAAC,UAAM,CACfxB,eAAe,CAAC,IAAD,CAAf,CACD,CAFS,CAEP,IAFO,CAAV,CAGD,CAND,CAQA,GAAMyB,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACP,MAAD,CAAY,CACvC,GAAIQ,CAAAA,OAAO,CAAGnC,OAAO,CAACoC,IAAR,CAAa,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACT,IAAF,GAAWD,MAAM,CAACC,IAAtB,EAAd,EAA6C5B,OAAO,CAACoC,IAAR,CAAa,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACT,IAAF,GAAWD,MAAM,CAACC,IAAtB,EAAd,CAAD,CAA4CU,EAAxF,CAA6F,CAA3G,CACA,GAAIH,OAAO,GAAK,CAAhB,CAAmB,CACjB,MAAO,MAAP,CACD,CACD,MAAOA,CAAAA,OAAP,CACD,CAND,CAQA,GAAMI,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,YAAD,CAAkB,CAC1CvC,UAAU,CAACD,OAAO,CAACyC,MAAR,CAAeD,YAAf,CAAD,CAAV,CACAjC,kBAAkB,CAACP,OAAO,CAACyC,MAAR,CAAeD,YAAf,CAAD,CAAlB,CACD,CAHD,CAKA,GAAME,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACxB,KAAD,CAAW,CAC3B,GAAMyB,CAAAA,SAAS,WAAMzC,OAAN,+CAAf,CACAgB,KAAK,CAAC0B,cAAN,GACA,GAAMJ,CAAAA,YAAY,CAAG,CACnBZ,IAAI,CAAE1B,OADa,CAEnB2C,MAAM,CAAEzC,SAFW,CAArB,CAKA,GAAI+B,CAAAA,OAAO,CAAGD,oBAAoB,CAACM,YAAD,CAAlC,CACA,GAAGL,OAAH,CAAY,CACV,GAAGW,MAAM,CAACC,OAAP,CAAeJ,SAAf,CAAH,CAA8B,CAC5B7C,aAAa,CACVkD,MADH,CACUb,OADV,CACmBK,YADnB,EAEG3B,IAFH,CAEQ,SAAAoC,aAAa,CAAI,CACrBnB,mBAAmB,6BAAsBU,YAAY,CAACZ,IAAnC,EAA2C,KAA3C,CAAnB,CACArB,kBAAkB,CAACD,eAAe,CAAC4C,GAAhB,CAAoB,SAAAvB,MAAM,QAAIA,CAAAA,MAAM,CAACC,IAAP,GAAgB1B,OAAhB,CAA0B+C,aAA1B,CAA0CtB,MAA9C,EAA1B,CAAD,CAAlB,CACA1B,UAAU,CAACK,eAAD,CAAV,CACD,CANH,EAOD,CACF,CAVD,IAUO,CACLR,aAAa,CACVqD,MADH,CACUX,YADV,EAEG3B,IAFH,CAEQ,SAAAuC,UAAU,CAAI,CAClBtB,mBAAmB,WAAIU,YAAY,CAACZ,IAAjB,2BAA+C,KAA/C,CAAnB,CACAW,iBAAiB,CAACa,UAAD,CAAjB,CACAjD,UAAU,CAAC,EAAD,CAAV,CACAE,YAAY,CAAC,EAAD,CAAZ,CACD,CAPH,EAQGgD,KARH,CAQS,SAAAC,KAAK,CAAI,CACdxB,mBAAmB,CAACwB,KAAK,CAACC,QAAN,CAAeC,IAAhB,CAAsB,IAAtB,CAAnB,CACD,CAVH,EAWD,CACF,CAhCD,CAkCA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAC7B,IAAD,CAAOU,EAAP,CAAc,CACjC,GAAGQ,MAAM,CAACC,OAAP,kBAAyBnB,IAAzB,MAAH,CAAsC,CACpC9B,aAAa,CACZ4D,YADD,CACcpB,EADd,EAECzB,IAFD,CAEM,UAAM,CACViB,mBAAmB,WAAIF,IAAJ,+BAAsC,KAAtC,CAAnB,CACArB,kBAAkB,CAACD,eAAe,CAACoB,MAAhB,CAAuB,SAAAC,MAAM,QAAIA,CAAAA,MAAM,CAACW,EAAP,GAAcA,EAAlB,EAA7B,CAAD,CAAlB,CACArC,UAAU,CAACK,eAAD,CAAV,CACD,CAND,EAOC+C,KAPD,CAOO,SAAAC,KAAK,CAAI,CACdvC,OAAO,CAACC,GAAR,CAAY,cAAZ,CAA4BsC,KAA5B,EACAxB,mBAAmB,WAAIF,IAAJ,4CAAmD,IAAnD,CAAnB,CACArB,kBAAkB,CAACD,eAAe,CAACoB,MAAhB,CAAuB,SAAAC,MAAM,QAAIA,CAAAA,MAAM,CAACW,EAAP,GAAcA,EAAlB,EAA7B,CAAD,CAAlB,CACArC,UAAU,CAACK,eAAD,CAAV,CACD,CAZD,EAaD,CACF,CAhBD,CAkBA,mBACE,oCACE,KAAC,YAAD,EAAc,OAAO,CAAEE,YAAvB,CAAqC,WAAW,CAAEE,WAAlD,EADF,cAEE,KAAC,MAAD,EAAQ,IAAI,CAAC,WAAb,EAFF,cAGE,KAAC,YAAD,EAAc,IAAI,CAAC,mBAAnB,CAAuC,YAAY,CAAEY,YAArD,EAHF,cAIE,KAAC,MAAD,EAAQ,IAAI,CAAC,WAAb,EAJF,cAKE,KAAC,aAAD,EACE,gBAAgB,CAAEL,gBADpB,CAEE,kBAAkB,CAAEI,kBAFtB,CAGE,SAAS,CAAEqB,SAHb,CAIE,OAAO,CAAExC,OAJX,CAIoB,SAAS,CAAEE,SAJ/B,EALF,cAWE,KAAC,MAAD,EAAQ,IAAI,CAAC,SAAb,EAXF,cAYE,KAAC,OAAD,EAAS,eAAe,CAAEE,eAA1B,CAA2C,YAAY,CAAEmD,YAAzD,EAZF,GADF,CAgBD,CAzHD,CA2HA,cAAe1D,CAAAA,GAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\n\nimport Header from './components/Header'\nimport SearchFilter from './components/SearchFilter'\nimport AddPeopleForm from './components/AddPeopleForm'\nimport Persons from './components/Persons'\nimport Notification from './components/Notification'\nimport personService from './services/personService'\n\nconst App = () => {\n  const [ persons, setPersons ] = useState([]) \n  const [ newName, setNewName ] = useState('')\n  const [ newNumber, setNewNumber ] = useState('')\n  const [ filteredPersons, setFilteredPersons ] = useState([])\n  const [ errorMessage, setErrorMessage ] = useState(null)\n  const [ errorStatus, setErrorStatus ] = useState(true)\n\n  useEffect(() => {\n    personService\n      .getAll()\n      .then(peopleList => {\n        console.log(\"initial data\", peopleList);\n        setPersons(peopleList)\n        setFilteredPersons(peopleList)\n      })\n  }, [])\n\n  const handleNameChange = (event) => setNewName(event.target.value);\n\n  const handleNumberChange = (event) => setNewNumber(event.target.value); \n\n  const handleSearch = (event) => {\n    let searchEntry = (event.target.value).toLowerCase()\n\n    if(searchEntry.length > 0) {\n      setFilteredPersons(persons.filter(person => person.name.toLowerCase().includes(searchEntry)))\n    } else {\n      setFilteredPersons([...persons])\n    }\n  }\n\n  const handleNotifications = (message, status) => {\n    setErrorMessage(message)\n    setErrorStatus(status)\n    setTimeout(() => {\n      setErrorMessage(null)\n    }, 5000)\n  }\n\n  const checkDuplicatePerson = (person) => {\n    let foundID = persons.find(p => p.name === person.name) ? (persons.find(p => p.name === person.name)).id : 0 \n    if (foundID === 0) {\n      return false\n    }\n    return foundID\n  }\n\n  const concatPersonLists = (personObject) => {\n    setPersons(persons.concat(personObject))\n    setFilteredPersons(persons.concat(personObject))\n  }\n\n  const addPerson = (event) => {\n    const alertText = `${newName} already exists. Update their phone number?`\n    event.preventDefault();\n    const personObject = {\n      name: newName,\n      number: newNumber\n    }\n\n    let foundID = checkDuplicatePerson(personObject)\n    if(foundID) {\n      if(window.confirm(alertText)) {\n        personService\n          .update(foundID, personObject)\n          .then(updatedPerson => {\n            handleNotifications(`Changed number of ${personObject.name}`, false)\n            setFilteredPersons(filteredPersons.map(person => person.name === newName ? updatedPerson : person))\n            setPersons(filteredPersons)\n          })\n      }\n    } else {\n      personService\n        .create(personObject)\n        .then(personList => {\n          handleNotifications(`${personObject.name} was added to the list`, false)\n          concatPersonLists(personList)\n          setNewName('');\n          setNewNumber('');\n        })\n        .catch(error => {\n          handleNotifications(error.response.data, true)\n        })\n    }\n  }\n\n  const deletePerson = (name, id) => {\n    if(window.confirm(`Delete ${name}?`)) {\n      personService\n      .deleteObject(id)\n      .then(() => {\n        handleNotifications(`${name} was removed from the list`, false)\n        setFilteredPersons(filteredPersons.filter(person => person.id !== id))\n        setPersons(filteredPersons)\n      })\n      .catch(error => {\n        console.log(\"Caught Error\", error);\n        handleNotifications(`${name} has already been removed from the list`, true)\n        setFilteredPersons(filteredPersons.filter(person => person.id !== id))\n        setPersons(filteredPersons)\n      })\n    } \n  }\n\n  return (\n    <div>\n      <Notification message={errorMessage} errorStatus={errorStatus} />\n      <Header text=\"Phonebook\" />\n      <SearchFilter text=\"filter shown with\" handleSearch={handleSearch} />\n      <Header text=\"add a new\" />\n      <AddPeopleForm \n        handleNameChange={handleNameChange} \n        handleNumberChange={handleNumberChange} \n        addPerson={addPerson} \n        newName={newName} newNumber={newNumber} \n      />\n      <Header text=\"Numbers\" />\n      <Persons filteredPersons={filteredPersons} deletePerson={deletePerson} />\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}